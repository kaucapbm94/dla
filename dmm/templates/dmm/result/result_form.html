{% extends 'dmm/layout/main.html' %}

{% block content %}
<div class="container mt-5">
	<form action="" method="POST" id="my_form" class="needs-validation">
		{% csrf_token %}
		<div class="row">
			{{ form.management_form }}
			<div class="col-12">
				<label>Текст публикации</label>
				{{ form.text }}
			</div>
			<div class="col-6">
				<label>Заголовок публикации<b class="text-danger">*</b></label>
				{{ form.title }}
			</div>
			<div class="col-6">
				<label>URL публикации<b class="text-danger">*</b></label>
				{{ form.url }}
			</div>
			<div class="col-3">
				<label>Дата публикации<b class="text-danger">*</b></label>
				{{ form.date }}
			</div>
			<div class="col-3">
				<label>Тип публикации<b class="text-danger">*</b></label>
				{{ form.content_type }}
			</div>
			<div class="col-3">
				<label>Язык публикации<b class="text-danger">*</b></label>
				{{ form.language_type }}
			</div>
			<div class="col-3">
				<label>Ресурс публикации<b class="text-danger">*</b></label>
				{{ form.resource_type }}
			</div>
			<div class="d-none">
				{{ form.expert.label }}
				{{ form.expert }}
			</div>
		</div>
		<div class="row">
			{{ formset.management_form }}
			<div class="col-12" id="comments">
				{% for f in formset %}
				<div class="row comment mt-2 border border-secondary rounded bg-light p-2" id="comment_set-{{ forloop.counter0 }}">
					<div class="col-11">
						{{ f.text.errors }}
						{{ f.text }}
						<div class="collapse comment-meta row" id="comment_set-{{ forloop.counter0 }}-meta">
							<div class="col-md-6">
								<label>URL комментатора<b class="text-danger">*</b></label>
								{{ f.author_url }}
							</div>
							<div class="col-md-3">
								<label>Дата комментирования<b class="text-danger">*</b></label>
								{{ f.date }}
							</div>
							<div class="col-md-12 d-none">
								{{ f.expert }}
							</div>
							<div class="col-md-3">
								<label>Язык комментирования<b class="text-danger">*</b></label>
								{{ f.language_type }}
							</div>
							<div class="col-md-3">
								<label>Ресурс комментирования<b class="text-danger">*</b></label>
								{{ f.resource_type }}
							</div>
							<div class="col-md-3">
								<label>Является ответом?</label>
								{{ f.is_answer }}
							</div>
							<div class="col-md-3">
								<label>Тональность<b class="text-danger">*</b></label>
								{{ f.tonal_type }}
							</div>
							<div class="col-md-3">
								<label>Класс<b class="text-danger">*</b></label>
								<a class="add_specie"><i class="far fa-plus-square"></i></a>
								{{ f.specie }}
							</div>
							<div class="col-md-3" id="comment_set-{{ forloop.counter0 }}-tags">
								<label>Теги<b class="text-danger">*</b></label>
								<a class="add_tag"><i class="far fa-plus-square"></i></a>
								</br>
								{% for tag in f.tags %}
								{% for t in tags %}
								{% if forloop.counter == forloop.parentloop.counter%}
								<div class="d-inline tag-div" data-toggle="tooltip" data-placement="top" title="{{ t.description }} ({{ t.expert.name }})">
									{{ tag }}
								</div>
								{% endif %}
								{% endfor %}
								{% endfor %}
							</div>
							<div class="col-md-12">
								<label>Пояснение</label>
								{{ f.clarification }}
							</div>
						</div>
					</div>
					<div class="col-1">
						<div class="row">
							<div class="col-6">
								<button class="btn btn-primary btn-sm" id="comment_set-{{ forloop.counter0 }}-meta-collapse" type="button" data-toggle="collapse" data-target="#comment_set-{{ forloop.counter0 }}-meta" aria-expanded="false" aria-controls="collapseExample">
									<i class="fas fa-chevron-circle-down"></i>
								</button>
							</div>
							<div class="col-6">
								<button class="btn btn-danger btn-sm comment-destroy" id="comment_set-{{ forloop.counter0 }}-destroy" type="button">
									<i class="fa fa-trash"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
	</form>
	<div class="col-md-12 mt-20">
		<button type="button" class="btn btn-primary btn-lg" id="add-comment">
			Ещё комментарий
		</button>
		<button id="my_submit" class="btn btn-success btn-lg">Submit</button>
	</div>
</div>


{% endblock content %}

{% block scripts %}
{%  include 'dmm/result/script.html' %}
{% endblock %}